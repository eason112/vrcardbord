<html>
  <head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
        <a-assets>
          <img id="skyTexture"
            src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/sechelt.jpg">
        <img id="imageTexture" src="https://github.com/eason112/vrcardbord/asset/image.png">
        <video id="video" src="https://github.com/eason112/vrcardbord/asset/video.mp4" autoplay="false" loop="false"></video>
        </a-assets>
      
      
        <a-sky src="#skyTexture"></a-sky>
        <a-plane class="clickable" id="imagePlane" position="4 1 -3" rotation="0 -45 0" width="3" height="2" src="#imageTexture"></a-plane>
    
          <!-- 影片播放器 -->
        <a-video id="videoPlayer" src="#video" position="4 1 -3" rotation="0 -45 0" width="3" height="2" visible="false"></a-video>

          
        <a-camera>
            <a-entity
            raycaster="objects:.clickable"
            id="cursor"
            cursor="fuse: true; fuseTimeout:3000"
            animation__fusing="property: scale; startEvents: fusing; dur: 3000; from: 1 1 1; to: 0.1 0.1 0.1"
            animation__reset="property: scale; startEvents: mouseleave; dur: 1000; to: 1 1 1"
            material="color: black; shader: flat"
            position="0 0 -3"
            geometry="primitive: ring; radius-inner:0.02; radius-outer:0.04;"></a-entity>
        </a-camera>
      </a-scene>
  </body>
  <script>
    // 用來追蹤圖片是否被注視的狀態
    let isLookingAtImage = false;
    let timer;
    let leavetimer;
    
    
    const cursor = document.querySelector('#cursor');  // 光标元素

    // 當光標進入圖片區域時
    document.querySelector('#imagePlane').addEventListener('mouseenter', function() {
      isLookingAtImage = true;
      // 設置光标顏色變為白色
      cursor.setAttribute('material', 'color: white');
      
      // 開始縮小光標的動畫
      //cursor.setAttribute('scale', '0.2 0.2 0.2');  // 初始缩小光标
      clearTimeout(leavetimer);  // 取消定時器
      // 設置定時器
      timer = setTimeout(() => {
        if (isLookingAtImage) {
          // 顯示影片
            document.querySelector('#videoPlayer').setAttribute('visible', 'true');
            document.querySelector('#videoPlayer').play();
        }
      }, 3000);  // 3秒後播放影片
    });

    // 當光標離開圖片區域時
    document.querySelector('#imagePlane').addEventListener('mouseleave', function() {
      isLookingAtImage = false;
      clearTimeout(timer);  // 取消定時器
      // 隱藏影片
      //document.querySelector('#videoPlayer').setAttribute('visible', 'false');
      leavetimer = setTimeout(() => {
          // 顯示影片
            //document.querySelector('#videoPlayer').setAttribute('visible', 'false');
            document.querySelector('#videoPlayer').pause();
            document.querySelector('#videoPlayer').currentTime=0; 
      }, 3000);  // 3秒後播放影片
      // 恢復光标狀態
      cursor.setAttribute('material', 'color: black');
    });
  </script>
</html>